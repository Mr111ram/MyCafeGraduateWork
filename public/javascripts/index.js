"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var a=[],r=!0,i=!1,n=void 0;try{for(var o,l=t[Symbol.iterator]();!(r=(o=l.next()).done)&&(a.push(o.value),!e||a.length!==e);r=!0);}catch(t){i=!0,n=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw n}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function storeDish(t){var e=$(".bar__input[data-id]"),a=$(".dish__push"),r=[],i=!0,n=!1,o=void 0;try{for(var l,s=e[Symbol.iterator]();!(i=(l=s.next()).done);i=!0){var d=l.value;if((d=$(d)).val()>0){var h=d.attr("data-id");r.push($($(".dish__item[data-dish-id]").get(h)).attr("data-dish-id"))}}}catch(t){n=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}$("#dish__push").html("");for(var c=0,_=r;c<_.length;c++){var u=_[c],f=$($(".dish__item[data-dish-id]").get(u)),m=document.createElement("div");m.classList.add("dish__item"),m.innerHTML=f.html(),m.setAttribute("data-dish-store-id",f.attr("data-dish-id"));var v=$(m).find(".bar__input"),b=v.attr("data-id"),p=$($(".dish .dish__item").get(b)).find(".bar__input[data-id]").val();v.removeAttr("data-id"),v.val(p),$(m).find(".bar__button[data-counter-type='decrement']").remove(),$(m).find(".bar__button[data-counter-type='increment']").removeAttr("data-counter-type").removeAttr("onclick").attr("onclick","removeDish(this)").addClass("btn-danger").attr("data-remove-dish-id","".concat(u)).text("Удалить"),a.append(m)}var g=$("#dish__push .dish__item"),y=$("#hall__push .container");g.length<=0?($("#dish__push").hide(),$(".container__dish").hide(),$("#stub__dish").show()):($("#stub__dish").hide(),$("#dish__push").show(),$(".container__dish").show()),!y.length<=0||!g.length<=0?$(".result").show():$(".result").hide(),$("#dish__push .dish__item[data-dish-store-id] .bar__input").on("change",updateValue),priceCalculate()}function initOdometer(){pageYOffset>=window.innerHeight/1.4&&($(".odometer.first").html("6"),$(".odometer.second").html("24"),$(".odometer.three").html("7"),$(window).off("scroll",initOdometer))}function priceCalculate(){var t=function(t){var e=parseInt(t);return isNaN(e)?0:e},e=$("#hall__push span.info__new-price"),a=$("#dish__push .bar__input"),r=$("#dish__push .dish__subtitle"),i=0;i+=t(e.text());var n=0,o=!0,l=!1,s=void 0;try{for(var d,h=a[Symbol.iterator]();!(o=(d=h.next()).done);o=!0){var c=d.value;i+=t($(r.get(n)).text())*t($(c).val()),n++}}catch(t){l=!0,s=t}finally{try{o||null==h.return||h.return()}finally{if(l)throw s}}$("#result__price").text(function(t){var e=t.toString().split("").reverse(),a=[],r=!0,i=!1,n=void 0;try{for(var o,l=e.entries()[Symbol.iterator]();!(r=(o=l.next()).done);r=!0){var s=_slicedToArray(o.value,2),d=s[0],h=s[1];0!==d&&d%3==0&&a.push(" "),a.push(h)}}catch(t){i=!0,n=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw n}}return a.reverse().join("")}(i))}function formCheak(){$("#formName, #formEmail, #formPlace, #formDate").on("change",function(){var t=!0,e=!0,a=!1,r=void 0;try{for(var i,n=$("#formName, #formEmail, #formPlace, #formDate")[Symbol.iterator]();!(e=(i=n.next()).done);e=!0){var o=i.value,l=$(o),s=void 0,d=void 0;switch(l.attr("id")){case"formName":s=/^[А-ЯA-Z][а-яa-zА-ЯA-Z\-]{0,}\s[А-ЯA-Z][а-яa-zА-ЯA-Z\-]{1,}(\s[А-ЯA-Z][а-яa-zА-ЯA-Z\-]{1,})?$/gi,d=l.val(),s.test(d)?l.removeClass("border-danger"):(l.addClass("border-danger"),t=!1);break;case"formEmail":s=/^((?!\.)[\w-_.]*[^.])(@\w+)(\.\w+(\.\w+)?[^.\W])$/gm,d=l.val(),s.test(d)?l.removeClass("border-danger"):(l.addClass("border-danger"),t=!1);break;case"formPlace":case"formDate":(d=l.val())||(t=!1)}}}catch(t){a=!0,r=t}finally{try{e||null==n.return||n.return()}finally{if(a)throw r}}$("#formContinue").attr("disabled",!t)})}$(document).ready(function(){$(window).on("scroll",initOdometer),$(window).on("resize",function(){$(".face").parallax({imageSrc:"/images/face__background.jpg"})}),$(".face").parallax({imageSrc:"/images/face__background.jpg"}),$("#store_button").on("mouseenter",function(){$("#storeFill").attr("fill","#fff")}).on("mouseleave",function(){$("#storeFill").attr("fill","#28a745")}),$(".anchor").on("click",function(t){t.preventDefault(),$($(t.target).attr("href")).get(0).scrollIntoView({behavior:"smooth",block:"start"})}),$("#formDate").attr("placeholder",(new Date).toLocaleString("ru",{month:"numeric",day:"numeric"}).split(".").join("/")).datepicker({format:"dd/mm",language:"ru"}),$(".bar__input").val("0").on("change",function(){var t=$(this),e=parseInt(t.val());isNaN(e)?t.val(0):e>=99?t.val(99):e<0&&t.val(0),storeDish(t)}),$("#store_button").on("click",function(){$(".body__main").toggleClass("active"),$(".body__shop").toggleClass("active"),$("#header").toggleClass("active"),$("body").toggleClass("overflow")}),$("#closeStore").on("click",function(){return $("#store_button").click()}),$(".container__dish, .container__hall").hide(),$(".set__hall").on("click",function(){var t=$(".hall__item"),e=$(this),a=e.attr("data-id"),r=$(t.get(a)).html();$(this).hasClass("btn-success")?($(".set__hall").removeClass("btn-success").text("Заказать"),$("#hall__push").html(""),$(".container__hall").hide(),$("#stub__hall").show(),$("#store__submit_button").hide()):($(".set__hall").removeClass("btn-success").text("Заказать"),e.addClass("btn-success").text("Заказанно"),$("#hall__push").html(r),$(".container__hall .set__hall").addClass("btn-danger remove__hall").text("Удалить").removeClass("set__hall"),$(".remove__hall").on("click",function(){var t=$(this).attr("data-id");$($(".hall__item").get(t)).find(".set__hall").click()}),$(".container__hall").show(),$("#stub__hall").hide(),$("#store__submit_button").show());var i=$("#dish__push .dish__item");!$("#hall__push .container").length<=0||!i.length<=0?$(".result").show():$(".result").hide(),priceCalculate()}),$(".result").hide(),$("#notification").on("change",function(){var t=$("#notification"),e=t.prop("checked");t.val(e.toString())}).change(),formCheak(),$("#formContinue").attr("disabled",!0).on("click",function(){if(!$(this).attr("disabled")){var t=$("#hall__push .container[data-hall-id]").attr("data-hall-id"),e=[],a=!0,r=!1,i=void 0;try{for(var n,o=$("#dish__push button[data-remove-dish-id]")[Symbol.iterator]();!(a=(n=o.next()).done);a=!0){var l=n.value,s=parseInt($(l).siblings().val()),d=0;do{d++,e.push($(l).attr("data-remove-dish-id"))}while(s>d)}}catch(t){r=!0,i=t}finally{try{a||null==o.return||o.return()}finally{if(r)throw i}}$("#formHall").val(t),$("#formDishes").val(e.join(";")),$("#storeForm").submit()}}),$("#store__submit_button").hide()}),window.count=function(t){var e=$(t.parentNode),a=$(t).attr("data-counter-type"),r=e.find(".bar__input"),i=r.val();"increment"===a?i<0?r.val(0):i>=99?r.val(99):r.val(parseInt(i)+1):i>0?r.val(parseInt(i)-1):r.val(0),r.change()},window.removeDish=function(t){var e=(t=$(t)).attr("data-remove-dish-id");$($(".dishes__container .bar__input[data-id]").get(e)).val(0).change()},window.updateValue=function(){self=$(this);var t=self.val(),e=self.parent().find(".bar__button").attr("data-remove-dish-id");$($("#dishes .bar__input").get(e)).val(t).change()};